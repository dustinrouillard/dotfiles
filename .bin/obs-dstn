#!/bin/bash

PROFILE=$1 # main / story

NAME="Main"
WEBSOCKET_PORT="4455"

GEOMETRY=AdnQywADAAAAAAAAAAAAZwAABA0AAAXPAAAAAAAAAGcAAAQNAAAFzwAAAAEAAAAACgAAAAAAAAAAZwAABA0AAAXP
DOCKS=AAAA/wAAAAD9AAAAAgAAAAEAAAFWAAAC+/wCAAAAAfsAAAAkAFYAZQByAHQAaQBjAGEAbABDAGEAbgB2AGEAcwBEAG8AYwBrAgAABf8AAAAMAAAD6wAABWwAAAADAAAEDgAAASv8AQAAAAb8AAAAAAAAAL0AAACgAP////wCAAAAAvsAAAAUAHMAYwBlAG4AZQBzAEQAbwBjAGsBAAAEHAAAASsAAACOAP////sAAAAwAFYAZQByAHQAaQBjAGEAbABDAGEAbgB2AGEAcwBEAG8AYwBrAFMAYwBlAG4AZQBzAQAAA60AAACUAAAAAAAAAAD8AAAAwQAAALYAAACgAP////wCAAAAAvsAAAAWAHMAbwB1AHIAYwBlAHMARABvAGMAawEAAAQcAAABKwAAAI4A////+wAAADIAVgBlAHIAdABpAGMAYQBsAEMAYQBuAHYAYQBzAEQAbwBjAGsAUwBvAHUAcgBjAGUAcwEAAAOtAAAAlAAAAAAAAAAA+wAAABIAbQBpAHgAZQByAEQAbwBjAGsBAAABewAAARoAAADeAP////wAAAKZAAAAtgAAAKAA/////AIAAAAC+wAAAB4AdAByAGEAbgBzAGkAdABpAG8AbgBzAEQAbwBjAGsBAAAEHAAAASsAAACKAP////sAAAA6AFYAZQByAHQAaQBjAGEAbABDAGEAbgB2AGEAcwBEAG8AYwBrAFQAcgBhAG4AcwBpAHQAaQBvAG4AcwEAAAPWAAAAawAAAAAAAAAA+wAAABgAYwBvAG4AdAByAG8AbABzAEQAbwBjAGsBAAADUwAAALsAAACeAP////sAAAASAHMAdABhAHQAcwBEAG8AYwBrAgAAA6IAAAJsAAACvAAAAMgAAAQOAAAEAQAAAAQAAAAEAAAACAAAAAj8AAAAAA==

# Change the name and websocket port for story mode ;)
if [[ $PROFILE == "story" ]]; then
    NAME="Story Time"
    WEBSOCKET_PORT="4456"

    GEOMETRY=AdnQywADAAAAAAAAAAAAZwAABBAAAAXPAAAAAAAAAGcAAAQQAAAFzwAAAAEAAAAACgAAAAAAAAAAZwAABBAAAAXP
    DOCKS=AAAA/wAAAAD9AAAAAwAAAAAAAAEnAAAFMPwCAAAABPsAAAAUAHMAYwBlAG4AZQBzAEQAbwBjAGsBAAAAFwAAANgAAACOAP////sAAAAWAHMAbwB1AHIAYwBlAHMARABvAGMAawEAAADzAAACEQAAAI4A////+wAAABIAbQBpAHgAZQByAEQAbwBjAGsBAAADCAAAAPUAAACKAP////sAAAAYAGMAbwBuAHQAcgBvAGwAcwBEAG8AYwBrAQAABAEAAAFGAAABKwD///8AAAABAAABVgAAAvv8AgAAAAH7AAAAJABWAGUAcgB0AGkAYwBhAGwAQwBhAG4AdgBhAHMARABvAGMAawIAAAX/AAAADAAAA+sAAAVsAAAAAwAABe8AAAEr/AEAAAAE/AAAAAAAAAFTAAAAAAD////8AgAAAAH7AAAAMABWAGUAcgB0AGkAYwBhAGwAQwBhAG4AdgBhAHMARABvAGMAawBTAGMAZQBuAGUAcwEAAAOtAAAAlAAAAAAAAAAA/AAAAAAAAAG9AAAAAAD////8AgAAAAH7AAAAMgBWAGUAcgB0AGkAYwBhAGwAQwBhAG4AdgBhAHMARABvAGMAawBTAG8AdQByAGMAZQBzAQAAA60AAACUAAAAAAAAAAD8AAADrgAAANUAAAAAAP////wCAAAAAvsAAAAeAHQAcgBhAG4AcwBpAHQAaQBvAG4AcwBEAG8AYwBrAAAABBwAAAErAAAAigD////7AAAAOgBWAGUAcgB0AGkAYwBhAGwAQwBhAG4AdgBhAHMARABvAGMAawBUAHIAYQBuAHMAaQB0AGkAbwBuAHMBAAAD1gAAAGsAAAAAAAAAAPsAAAASAHMAdABhAHQAcwBEAG8AYwBrAgAAA6IAAAJsAAACvAAAAMgAAALmAAAFMAAAAAQAAAAEAAAACAAAAAj8AAAAAA==
fi

# Replace the websocket port and dock info
kwriteconfig5 --file ~/.config/obs-studio/global.ini --group OBSWebSocket --key ServerPort ${WEBSOCKET_PORT}
kwriteconfig5 --file ~/.config/obs-studio/global.ini --group BasicWindow --key DockState ${DOCKS}
kwriteconfig5 --file ~/.config/obs-studio/global.ini --group BasicWindow --key geometry ${GEOMETRY}

# Open OBS with the profile and scene collection and ignore multiples.
obs --profile "$NAME" --collection "$NAME" -m
